<div class="timeline-grid">
  <div #leftPanel class="timeline-grid__left-panel" (scroll)="onLeftPanelScroll($event)">
    <div class="timeline-grid__work-center-header timeline-grid__work-center-header--work-center">
      <span
        class="timeline-grid__work-center-header-text timeline-grid__work-center-header-text--work-center"
        >Work Center</span
      >
    </div>
    @for (workCenter of workCenters(); track workCenter.docId) {
      <div class="timeline-grid__work-center-row">
        <span class="timeline-grid__work-center-name">{{ workCenter.data.name }}</span>
      </div>
    }
  </div>
  <div class="timeline-grid__right-panel">
    <div class="timeline-grid__header">
      @for (column of gridColumns(); track trackColumn(column)) {
        <div class="timeline-grid__column" [style.width.px]="column.width">
          {{ column.label }}
        </div>
      }
    </div>
    <div #rightContent class="timeline-grid__content" (scroll)="onRightPanelScroll($event)">
      @if (todayPosition() !== null) {
        <div class="timeline-grid__today-indicator" [style.left.px]="todayPosition()!">
          <span class="timeline-grid__today-label">Today</span>
        </div>
      }
      <!-- Timeline grid rows -->
      @for (workCenter of workCenters(); track workCenter.docId) {
        <div class="timeline-grid__row">
          <!-- Timeline row (clickable area) -->
          <div
            class="timeline-grid__timeline-row timeline-grid__timeline-row--hoverable"
            [ngbTooltip]="emptySlotTooltip"
            placement="top"
            [openDelay]="300"
            container="body"
            (click)="onTimelineRowClick($event, workCenter)"
          >
            <!-- Date columns (empty cells) -->
            @for (column of gridColumns(); track trackColumn(column)) {
              <div class="timeline-grid__cell" [style.width.px]="columnWidth()"></div>
            }

            <!-- Work order bars container -->
            <div class="timeline-grid__bars-container">
              @for (order of getOrdersForCenter(workCenter.docId); track order.docId) {
                <app-work-order-bar
                  [workOrder]="order"
                  [columnWidth]="columnWidth()"
                  [zoomLevel]="zoomLevel()"
                  [dateRangeStart]="dateRange().start"
                  (editClicked)="onWorkOrderEdit($event)"
                  (deleteClicked)="onWorkOrderDelete($event)"
                  (barClicked)="onWorkOrderClick($event)"
                />
              }
            </div>
          </div>
        </div>
      }
    </div>
  </div>
</div>
